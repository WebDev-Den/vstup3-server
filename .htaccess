RewriteEngine On

# ‚úÖ –î–æ–∑–≤–æ–ª–∏—Ç–∏ –ª–∏—à–µ .pdf —É /templates/output/ —ñ –≤–∫–ª–∞–¥–µ–Ω–∏—Ö
RewriteCond %{REQUEST_URI} ^/templates/output/ [NC]
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_URI} !\.pdf$ [NC]
RewriteRule ^ - [F]

# ‚úÖ –î–æ–∑–≤–æ–ª–∏—Ç–∏ PDF-—Ñ–∞–π–ª–∏ —É /templates/output/ —ñ –≤–∫–ª–∞–¥–µ–Ω–∏—Ö
RewriteCond %{REQUEST_URI} ^/templates/output/ [NC]
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# ‚ùå –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø–∞–ø–æ–∫ (—É —Ç.—á. –≤–∫–ª–∞–¥–µ–Ω–∏—Ö) –≤ /templates/output/
RewriteCond %{REQUEST_URI} ^/templates/output/ [NC]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [F]

# üåê –û—Å–Ω–æ–≤–Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è: –≤—Å–µ —ñ–Ω—à–µ ‚Äî –Ω–∞ index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [QSA,L]

# üîí –ë–µ–∑–ø–µ–∫–∞: –∫—Ä–∏—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏
<FilesMatch "\.(htaccess|htpasswd|env|ini|log|sql|bak|backup|conf|config)$">
    Require all denied
</FilesMatch>

# üîí –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ PHP (–∫—Ä—ñ–º index.php)
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+(.+)\.php[\s?] [NC]
RewriteCond %1 !^index$
RewriteRule ^ - [F]

# üîí –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è SQL / script —ñ–Ω'—î–∫—Ü—ñ–π
RewriteCond %{REQUEST_URI} !^/api/ [NC]
RewriteCond %{QUERY_STRING} \b(union|select|insert|delete|update|drop|create|alter)\s*(\(|\=) [NC,OR]
RewriteCond %{QUERY_STRING} (script|javascript|vbscript) [NC,OR]
RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} %00 [NC]
RewriteRule ^ - [F,L]

# üîí –ü—Ä–∏—Ö–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# ‚ùå –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –ª–∏—Å—Ç–∏–Ω–≥ –ø–∞–ø–æ–∫
Options -Indexes

# üîß PHP –±–µ–∑–ø–µ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
<IfModule mod_php.c>
    php_flag display_errors Off
    php_flag expose_php Off
    php_flag allow_url_fopen Off
    php_flag allow_url_include Off
</IfModule>
